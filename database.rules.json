{
  "rules": {
    "members": {
      "$member_uid": {
        ".read": "auth != null",

        // Only the member is able to update his/her profile
        ".write": "auth != null && auth.uid == $member_uid"
      },

      // List of members
      ".read": "auth != null"
    },

    "prayers": {
      "$prayer_id": {
        "views": {
          ".write": "auth != null"
        },

        "comments": {
          "$comments_id": {
            ".write": "auth != null",
            ".validate": "newData.hasChildren(['content', 'createdBy', 'createdAt']) && newData.child('createdBy').val() == auth.uid"
          }
        },

        // New prayer: any authenticated users
        // Delete / Edit a prayer: only the owner
        ".write": "auth != null && (!data.exists() || (data.exists() && data.child('poster').val() == auth.uid))"
      },

      // List of prayers
      ".read": "auth != null",
    }
  }
}